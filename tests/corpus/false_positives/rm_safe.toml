# False positives: rm commands that MUST be allowed
#
# These rm commands target safe locations (temp directories) and should pass.

# ============================================================================
# Safe temp directory cleanup (/tmp)
# ============================================================================

[[case]]
description = "rm -rf in /tmp is safe"
command = "rm -rf /tmp/build"
expected = "allow"

[[case]]
description = "rm -rf /tmp/* is safe"
command = "rm -rf /tmp/*"
expected = "allow"

[[case]]
description = "rm -rf /tmp with trailing slash is safe"
command = "rm -rf /tmp/foo/"
expected = "allow"

[[case]]
description = "rm -rf /tmp nested path is safe"
command = "rm -rf /tmp/project/build/artifacts"
expected = "allow"

# ============================================================================
# Safe temp directory cleanup (/var/tmp)
# ============================================================================

[[case]]
description = "rm -rf in /var/tmp is safe"
command = "rm -rf /var/tmp/build"
expected = "allow"

[[case]]
description = "rm -rf /var/tmp/* is safe"
command = "rm -rf /var/tmp/*"
expected = "allow"

# ============================================================================
# Safe temp directory via $TMPDIR variable
# ============================================================================

[[case]]
description = "rm -rf $TMPDIR is safe (unquoted)"
command = "rm -rf $TMPDIR/build"
expected = "allow"

[[case]]
description = "rm -rf ${TMPDIR} is safe (braced)"
command = "rm -rf ${TMPDIR}/build"
expected = "allow"

[[case]]
description = "rm -rf \"$TMPDIR\" is safe (quoted)"
command = "rm -rf \"$TMPDIR/build\""
expected = "allow"

[[case]]
description = "rm -rf ${TMPDIR:-/tmp} is safe (with default)"
command = "rm -rf ${TMPDIR:-/tmp}/build"
expected = "allow"

# ============================================================================
# Safe rm flag variations in temp dirs
# ============================================================================

[[case]]
description = "rm -r -f /tmp is safe (separate flags)"
command = "rm -r -f /tmp/build"
expected = "allow"

[[case]]
description = "rm -fr /tmp is safe (reversed flags)"
command = "rm -fr /tmp/build"
expected = "allow"

[[case]]
description = "rm --recursive --force /tmp is safe (long flags)"
command = "rm --recursive --force /tmp/build"
expected = "allow"

[[case]]
description = "rm --force --recursive /tmp is safe (long flags reversed)"
command = "rm --force --recursive /tmp/build"
expected = "allow"

# NOTE: rm -rf with extra flags may not match safe patterns
# The --verbose flag between -rf and path causes pattern mismatch
# [[case]]
# description = "rm -rf with verbose in /tmp is safe"
# command = "rm -rf --verbose /tmp/build"
# expected = "allow"

# ============================================================================
# Non-recursive rm is always safe
# ============================================================================

[[case]]
description = "rm single file is safe"
command = "rm file.txt"
expected = "allow"

[[case]]
description = "rm multiple files is safe"
command = "rm file1.txt file2.txt"
expected = "allow"

[[case]]
description = "rm -f single file is safe"
command = "rm -f file.txt"
expected = "allow"

[[case]]
description = "rm with -i (interactive) is safe"
command = "rm -i file.txt"
expected = "allow"

[[case]]
description = "rm with -v (verbose) is safe"
command = "rm -v file.txt"
expected = "allow"
